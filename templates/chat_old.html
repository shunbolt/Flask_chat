<!DOCTYPE html>
<html>
<head>
	<title>Chatbot LIA Test</title>
</head>
<body>
	
	<h3 style='color: #ccc;font-size: 30px;'>No message yet..</h3>
    <div class="message_holder"></div>

    <!-- Create form to enter message -->
	<form action="" method="POST">
	      <input type="text" class="message" placeholder="Messages"/>
	      <input type="submit"/>
	</form>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
    <!-- Insert Javascript code -->
    <script type="text/javascript">

    // Socket object to establish connection and create session client/server 
	var socket = io.connect('http://' + document.domain + ':' + location.port);

	/* 
		Event names ‘connect’, ‘disconnect’, ‘message’ and ‘json’ are special events generated by SocketIO.
		Any other event names are considered custom events.
	*/

	// Socket behavior on event 'connect'
	socket.on( 'connect', function() {
		// .emit sends a message under a custom event name with data
	  socket.emit( 'chat_event', {
	    data: 'User Connected'
	  })
	  // jQuery that searches for the first <form> context
	  var form = $( 'form' ).on( 'submit', function( e ) {
	  	// Prevents from submitting the form 
	    e.preventDefault()
	    // Input message as variable
	    let user_input = $( 'input.message' ).val()
	    // Sends message as chat_event
	    socket.emit( 'chat_event', {
	      message : user_input
	    })
	    // Clear message field
	    $( 'input.message' ).val( '' ).focus()
	  })
	})
	// Socket behavior on event 'chat_response'
	socket.on('chat_response', function( msg ) {
	  // Prints message
	  console.log( msg )
	  // Render the message on html page
	  if( typeof msg.message !== 'undefined' ) {
	    $( 'h3' ).remove()
	    $( 'div.message_holder' ).append('<div><b style="color:#000"> User </b>'+msg.message+'</div>' )
	  }
	})
	</script>

	
</body>
</html>